!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.GCA_Utils=e():t.GCA_Utils=e()}(self,(()=>(()=>{"use strict";var t={d:(e,i)=>{for(var s in i)t.o(i,s)&&!t.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:i[s]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e),r:t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}},e={};t.r(e),t.d(e,{InfoPopup:()=>r,MessagePopup:()=>d,ModelPopup:()=>c,PopupDialog:()=>n,Sidebar:()=>a,Utility:()=>o,capitalizeFirst:()=>s,clamp:()=>i,getCurrentScriptPath:()=>l});let i=(t,e,i)=>e<i?t<e?e:t>i?i:t:t<i?i:t>e?e:t,s=t=>t.toLowerCase().replace(/(^\w|\s\w)/g,(t=>t.toUpperCase())),l=function(t=0){let e=(new Error).stack.split("\n"),i=0;for(let t in e)if(e[t].match(/(file|http|https|webpack):\/\//)&&!(e[t].indexOf("getCurrentScriptPath")>=0)){i=Number(t);break}let s=e[i].match(/(((file|http|https|webpack):\/\/.+\/)([^\/]+\.js))/i)[2].split("/");return s.length=Math.max(1,s.length-t-1),s.join("/")};class o{static condenseText(t,e){let i=t.text();if(t.length()>e&&(t.attr("word-spacing","-1px"),t.length()>e&&(t.attr("letter-spacing","0px"),t.length()>e))){t.attr("letter-spacing","-0.2px");let s=0;for(;t.length()>e;){if(s>i.length/4)return!1;i=i.substr(0,i.length-1),t.text(i),s++}}return!0}static relativePos(t,e=!1){let i=t.target||t.srcElement;e&&(i=i.parentNode||i.parentElement);let s=i.getBoundingClientRect();return{x:t.clientX-s.left-1,y:t.clientY-s.top-1}}static handleClicks(t,e,...i){o.clickTimer?(clearTimeout(o.clickTimer),o.clickTimer=null,e(...i)):o.clickTimer=setTimeout((function(){t(...i),o.clickTimer=null}),200)}static colorBlend(t,e,s=.5){let l=!1;"#"==t[0]&&(t=t.slice(1),l=!0),"#"==e[0]&&(e=e.slice(1));let o=parseInt(e,16),a=1-s,n=i(Math.round((o>>16)*a),0,255),r=i(Math.round((o>>8&255)*a),0,255),d=i(Math.round((255&o)*a),0,255),c=parseInt(t,16),h=i(Math.round((c>>16)*s+n),0,255);h=(h<16?"0":"")+h.toString(16);let p=i(Math.round((c>>8&255)*s+r),0,255);p=(p<16?"0":"")+p.toString(16);let u=i(Math.round((255&c)*s+d),0,255);return u=(u<16?"0":"")+u.toString(16),(l?"#":"")+h+p+u}static colorShade(t,e){let s=!1;"#"==t[0]&&(t=t.slice(1),s=!0);let l=parseInt(t,16),o=i(Math.round((l>>16)*e),0,255);o=(o<16?"0":"")+o.toString(16);let a=i(Math.round((l>>8&255)*e),0,255);a=(a<16?"0":"")+a.toString(16);let n=i(Math.round((255&l)*e),0,255);return n=(n<16?"0":"")+n.toString(16),(s?"#":"")+o+a+n}static addElement(t,e,i,s,l=!1){let o=document.createElement(e);return o.id=i,l?t.prepend(o):t.append(o),s&&(o.className=s),o}htmlToElems(t){let e=document.createElement("template");return e.innerHTML=t,e.content.childNodes}static addStyle(t,e){let i=document.createElement("style");return i.type="text/css",document.getElementsByTagName("head")[0].appendChild(i),(i.sheet||{}).insertRule?i.sheet.insertRule(t+" {"+e+"}",0):(i.styleSheet||i.sheet).addRule(t,e),i.sheet.rules[0]}static getStyle(t){for(let e of document.styleSheets)try{let i=e.rules||e.cssRules;for(let e of i)if(e.selectorText==t)return e}catch(t){continue}}static htmlToElem(t){let e=document.createElement("template");return t=t.trim(),e.innerHTML=t,e.content.firstChild}static innerDimensions=t=>{let e=getComputedStyle(t),i=t.clientHeight,s=t.clientWidth;return i-=parseFloat(e.paddingTop)+parseFloat(e.paddingBottom),i-=parseFloat(e.marginTop)+parseFloat(e.marginBottom),s-=parseFloat(e.paddingLeft)+parseFloat(e.paddingRight),s-=parseFloat(e.marginLeft)+parseFloat(e.marginRight),{height:i,width:s}};static innerHeight=t=>{let e=getComputedStyle(t),i=t.clientHeight;return i-=parseFloat(e.paddingTop)+parseFloat(e.paddingBottom),i-=parseFloat(e.marginTop)+parseFloat(e.marginBottom),i};static innerWidth=t=>{let e=getComputedStyle(t),i=t.clientWidth;return i-=parseFloat(e.paddingLeft)+parseFloat(e.paddingRight),i-=parseFloat(e.marginLeft)+parseFloat(e.marginRight),i};static fetchShim(){if(-1!=navigator.userAgent.indexOf("Chrome")&&/^file:\/\/\//.test(location.href)){let t="./",e=fetch;window.fetch=i=>/^[^/:]*:/.test(i)?e(i):new Promise((function(e,s){let l=new XMLHttpRequest,o=t=>{s(t)};["error","abort"].forEach((t=>{l.addEventListener(t,o)}));let a=t=>new Promise(((e,i)=>{l.responseType==t||"text"==t&&!l.responseType?e(l.response):i(l.responseType)}));l.addEventListener("load",(()=>e({arrayBuffer:()=>a("arraybuffer"),blob:()=>a("blob"),text:()=>a("text"),json:()=>a("json")}))),l.open("GET",i.replace(/^\//,t)),l.send()}))}}static loadJson(t){let e,i=new XMLHttpRequest;return i.open("GET",t,!1),i.overrideMimeType("text/html"),i.send(null),200===i.status&&(e=JSON.parse(i.responseText)),e}static getCurrentScriptLocation(){return(new Error).stack.split("\n")[1].split("@").pop()}static getCurrentScriptPath(t=0){let e=o.getCurrentScriptLocation(),i=e.lastIndexOf("/"),s="";for(i>0&&(s=e.substr(0,i));t>0&&i>0;)i=s.lastIndexOf("/",i),i>0&&(s=s.substr(0,i)),t--;return s}static addStylesheet(t){if(null==t||null==t)return;let e=document.createElement("link");e.rel="stylesheet",e.type="text/css",e.href=t,document.head.appendChild(e)}}class a{constructor(t,e,i,s,l,a=.5){switch(this.collapsedWidth="6px",this.id=i,this.container=t,this.position=e.trim().toLowerCase(),this.content=s,this.width="number"==typeof l?l+"px":l,this.isCollapsed=!0,this.sidebar=o.htmlToElem(`<div id="${this.id}" class="sidebar"><div id="${this.id}_wrapper"> ${this.content}</div></div>`),this.sidebar.onmouseenter=this.open.bind(this),this.sidebar.onmouseleave=this.close.bind(this),this.container.appendChild(this.sidebar),this.wrapper=document.getElementById(`${this.id}_wrapper`),this.sidebar.style.width=this.width,this.sidebar.style.opacity="0",this.delay=a,this.posDelay=` ${this.delay}s`,this.position){case"left":this.sidebar.style.right=`calc(100% - ${this.collapsedWidth})`;break;case"right":this.sidebar.style.left=`calc(100% - ${this.collapsedWidth})`}this.isActive=!0}toggleSidebar1(){this.isCollapsed?this.open():this.close()}setSidebarCollapse(t){if(!this.isActive)return;let e=t?`calc(100% - ${this.collapsedWidth})`:`calc(100% - ${this.width})`;switch(this.position){case"left":this.sidebar.style.transition="right"+this.posDelay,this.sidebar.style.right=e;break;case"right":this.sidebar.style.transition="left"+this.posDelay,this.sidebar.style.left=e}this.sidebar.style.transition+=t?`, opacity ${2*this.delay}s`:", opacity 0s",this.sidebar.style.opacity=t?"0":"0.92",this.isCollapsed=t}open(){this.onopen&&this.onopen(),this.setSidebarCollapse(!1)}close(){this.onclose&&this.onclose(),this.setSidebarCollapse(!0)}hold(){this.sidebar.onmouseenter=this.sidebar.onmouseleave=null}unhold(){this.sidebar.onmouseenter=this.open.bind(this),this.sidebar.onmouseleave=this.close.bind(this)}setActive(t){t||this.isCollapsed||this.toggleSidebar(),this.isActive=t}setOnopen(t){this.onopen=t}setOnclose(t){this.onclose=t}}class n{constructor(t,e,i,s,l){this.dialogName=t;let a=o.htmlToElem(`<div id="${this.dialogName}-dialog" title="${e}" tabindex="-1">${i}</div>`);s.appendChild(a),l?(this.dialog=$(`#${this.dialogName}-dialog`).dialog(l),this.setDialogTitle(e)):this.title=e,this.init()}static setDialogTheme(t,e,i){let s=o.getStyle(".ui-dialog .ui-dialog-content");s&&(s.style.backgroundColor=t,s.style.color=e),s=o.getStyle(".ui-dialog .ui-dialog-buttonpane"),s&&(s.style.backgroundColor=t,s.style.color=e),s=o.getStyle(".ui-widget.ui-widget-content"),s&&(s.style.backgroundColor=t,s.style.borderColor=i),s=o.getStyle(".ui-widget-content a"),s&&(s.style.backgroundColor=t,s.style.color=e),s=o.getStyle(".help-container"),s&&(s.style.backgroundColor=t,s.style.color=e)}configDialog(t,e=!0){if(this.dialog=$(`#${this.dialogName}-dialog`).dialog(t),this.dialog.on("dialogopen",this.setClickHandler.bind(this)),e){let t=this.dialog[0];Number.isInteger(e)?t.addEventListener("mouseleave",this.close.bind(this,e)):t.addEventListener("mouseleave",this.close.bind(this))}}setClickHandler(){let t=this.dialog.dialog("widget")[0];t.onclick=this.handleClick.bind(this);for(let e of $(t).find(".ui-dialog-titlebar-close"))e.tabIndex=-1}handleClick(t){t.stopPropagation()}setDialogTitle(t){this.title=t,this.dialog?this.dialog.dialog({title:t}):$(`#${this.dialogName}-dialog`).dialog({title:t})}close(t=0){0==t?this.dialog.dialog("close"):setTimeout(this.close.bind(this,0),t)}}class r extends n{constructor(t,e,i,s){super(t,e,i,s),this.configDialog({autoOpen:!1,hide:"fade",show:"blind",buttons:{Close:this.close.bind(this)}})}close(){this.item=null,this.onclose&&(this.onclose(),this.onclose=null),this.dialog.dialog("close")}open(t,e=null,i=null){if(this.onclose=i,this.item!==t){if(this.item=t,e){let t=e.getBoundingClientRect();this.dialog.dialog({position:{of:window,my:"left top",at:`left+${t.left+1} top+${t.bottom+1}`,collision:"fit fit"}})}this.showContent(t),this.dialog.dialog("open")}else this.close()}}class d extends r{constructor(t){super("message-popup","3D Model",' <label id="alert-message" class="text popup-data"></label>',t)}init(){this.message=$("#alert-message")[0]}showContent(t){this.message.textContent=t}}class c extends r{constructor(t,e="GCA model"){super("model-popup",e,' <label for="model-name" class="label" >Name:</label>\n\t\t\t\t\t\t<label id="model-name" class="text popup-data"></label>\n\t\t\t\t\t\t<p/>\n\t\t\t\t\t\t<label class="label">Version:</label>\n\t\t\t\t\t\t<label id="model-version" class="text popup-data"></label>\n\t\t\t\t\t\t<p/>\n\t\t\t\t\t\t<label class="label">Species:</label>\n\t\t\t\t\t\t<label id="model-species" class="text popup-data"></label>\n\t\t\t\t\t\t<p/>\n\n\t\t\t\t\t\t<label class="label">Owner:</label>\n\t\t\t\t\t\t<label id="model-owner" class="text popup-data"></label>\n\t\t\t\t\t\t<p/>\n\t\t\t\t\t\t\n\t\t\t\t\t\t<label class="label">Description:</label>\n\t\t\t\t\t\t<label id="model-desc" class="text popup-data"></label>\n\t\t\t\t\t\t<p/>\n\t\t\t\t\t\t\n\t\t\t\t\t\t<label class="label">Contact:</label>\n\t\t\t\t\t\t<a id="model-contact" href=""></a>',t)}open(t,e=null,i=null){this.setDialogTitle("GCA "+(t.type?t.type:"")+" Model"),super.open(t,e,i)}init(){this.name=$("#model-name")[0],this.version=$("#model-version")[0],this.desc=$("#model-desc")[0],this.owner=$("#model-owner")[0],this.species=$("#model-species")[0],this.contact=$("#model-contact")[0],this.contact.blur()}showContent(t){this.name.textContent=t.name,this.version.textContent=t.version,this.desc.textContent=t.description||t.name,this.owner.textContent=t.owner,this.species.textContent=t.species,this.contact.href="mailto:"+t.contact,this.contact.textContent=t.contact}}return e})()));